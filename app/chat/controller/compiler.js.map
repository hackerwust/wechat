{
    "version": 3,
    "sources": [
        "../../../src/chat/controller/compiler.js"
    ],
    "names": [],
    "mappings": "AAAA;;;;;;;;;;;;;;;;AAQA;;;;;;AANA,IAAI,KAAK,QAAQ,IAAR,CAAT;AACA,IAAI,SAAS,QAAQ,QAAR,CAAb;AACA,IAAI,SAAS,QAAQ,eAAR,CAAb;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;;;;;;;;;;mBAME,W,wBAAY,I,EAAM;AAChB,QAAI,OAAO,KAAK,IAAhB;AACA,QAAI,OAAO,KAAK,KAAL,CAAW,IAAX,IAAmB,EAA9B;AACA,QAAI,OAAO,KAAK,KAAL,CAAW,IAAX,IAAmB,EAA9B;AACA,QAAI,CAAC,IAAD,IAAS,CAAC,IAAd,EAAoB;AAClB,aAAO,KAAK,GAAL,CAAS,uBAAT,CAAP;AACD;AACD,QAAI,QAAQ,KAAK,KAAL,CAAW,GAAX,CAAZ;AACA,QAAI,YAAY,MAAM,IAAN,CAAW,GAAX,CAAhB;AACA,gBAAY,KAAK,IAAL,CAAU,MAAM,SAAhB,EAA2B,YAA3B,EAAyC,SAAzC,CAAZ;AACA,QAAI;AACF,SAAG,QAAH,CAAY,SAAZ,EAAuB,MAAvB,EAA+B,UAAS,GAAT,EAAc,IAAd,EAAoB;AACjD,YAAI,GAAJ,EAAS;AACP,iBAAO,KAAK,GAAL,CAAS,oBAAoB,IAAI,QAAJ,EAA7B,CAAP;AACD,SAFD,MAEO;AACL,iBAAO,KAAK,QAAL,MAAmB,EAA1B;AACA,cAAI,QAAQ,QAAZ,EAAsB;AACpB,mBAAO,OAAO,OAAP,CAAe,IAAf,CAAP;AACA,iBAAK,IAAL,CAAU,wBAAV;AACA,iBAAK,GAAL,CAAS,IAAT;AACD,WAJD,MAIO,IAAI,QAAQ,QAAZ,EAAsB;AAC3B,mBAAO,IAAP,EAAa,GAAb,CAAiB,OAAjB,EAA0B,CAAC,SAAD,CAA1B,EAAuC,MAAvC,CAA8C,UAAS,GAAT,EAAc,GAAd,EAAmB;AAC/D,kBAAI,GAAJ,EAAS;AACP,qBAAK,GAAL,CAAS,0BAA0B,IAAI,QAAJ,EAAnC;AACD,eAFD,MAEO;AACL,qBAAK,IAAL,CAAU,UAAV;AACA,qBAAK,GAAL,CAAS,GAAT;AACD;AACF,aAPD;AAQD,WATM,MASA,IAAI,QAAQ,MAAZ,EAAoB;AACzB,gBAAI,KAAK,KAAK,aAAL,CAAmB,IAAnB,CAAT;AACA,gBAAI,OAAO,GAAG,QAAH,EAAX;AACA,iBAAK,IAAL,CAAU,wBAAV;AACA,iBAAK,GAAL,CAAS,yBAAyB,IAAzB,GAAgC,uBAAzC;AACD,WALM,MAKA;AACL,iBAAK,GAAL,CAAS,cAAT;AACD;AACF;AACF,OA3BD;AA4BD,KA7BD,CA6BE,OAAO,CAAP,EAAU;AACV,WAAK,GAAL,CAAS,WAAW,EAAE,QAAF,EAApB;AACD;AACF,G",
    "file": "../../../src/chat/controller/compiler.js",
    "sourcesContent": [
        "'use strict';\n\nvar fs = require(\"fs\");\nvar stylus = require(\"stylus\");\nvar coffee = require(\"coffee-script\");\nvar jade = require(\"jade\");\nvar path = require(\"path\");\n\nimport Base from './base.js';\n\nexport default class extends Base {\n  \n  indexAction(self) {\n    var http = self.http;\n    var type = http.query.type || \"\";\n    var file = http.query.path || \"\";\n    if (!type || !path) {\n      return http.end(\"type or path is empty\");\n    }\n    var paths = file.split(\"|\");\n    var file_path = paths.join(\"/\");\n    file_path = path.join(think.ROOT_PATH, \"www/static\", file_path);\n    try {\n      fs.readFile(file_path, \"utf8\", function(err, data) {\n        if (err) {\n          return http.end(\"readFile error:\" + err.toString());\n        } else {\n          data = data.toString() || \"\";\n          if (type == \"coffee\") {\n            data = coffee.compile(data);\n            http.type(\"application/javascript\");\n            http.end(data);\n          } else if (type == \"stylus\") {\n            stylus(data).set(\"paths\", [file_path]).render(function(err, css) {\n              if (err) {\n                http.end(\"stylus compile error:\" + err.toString());\n              } else {\n                http.type(\"text/css\");\n                http.end(css);\n              }\n            });\n          } else if (type == \"jade\") {\n            var fn = jade.compileClient(data);\n            var code = fn.toString();\n            http.type('application/javascript');\n            http.end('define(function(){\\n' + code + ';\\nreturn template;})');\n          } else {\n            http.end(\"invalid type\");\n          }   \n        }\n      });\n    } catch (e) {\n      http.end(\"error:\" + e.toString());\n    }    \n  }\n\n}"
    ]
}